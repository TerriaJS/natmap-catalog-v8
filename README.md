# V8 National Map Catalog !

## How to build

```
node .\natmap\build.js
```

Catalog will be saved to `./out.json`

## AREMI catalog

Currently, there are manual modifications to v8 AREMI catalog:

- Untouched v8 JSON generated by `catalog-converter`: `natmap\in\aremi-2020-09-22-v8.json`
- v8 JSON with manual modifications `natmap\in\aremi-2020-09-22-v8-with-mods.json`

This approach is not ideal, but will let you see changes using a diff-tool. These changes should be made with JavaScript.

## To update catalog

1. Run `catalog-converter` on nationalmap/aremi catalog
2. Copy input (v7) and output (v8) to `natmap\in` and rename to match naming patterns:
  - `natmap\in\natmap-2020-09-03.json`
  - `natmap\in\natmap-2020-09-03-v8.json`
  
  
 ## Deploy
 
 Currently, we are storing NationalMap catalogs at https://tiles.terria.io/static/natmap-prod-2021-02-01-1406-converted-v8.json, 
 which is an S3 bucket here - https://s3.console.aws.amazon.com/s3/buckets/tiles.terria.io?region=ap-southeast-2&prefix=static/
 
 To deploy, rename `out.json` to follow something like `natmap-prod-2021-02-01-1406-converted-v8.json` pattern - and then update URL in `initializationUrls` in SaaS `map-config`  
 - **Dev:** https://dev.saas.terria.io/record-editor/map-config-nationalmap
 - **Test:** https://test.saas.terria.io/record-editor/map-config-nationalmap
 - **Prod:** https://saas.terria.io/record-editor/map-config-nationalmap
